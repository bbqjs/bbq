<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="UpdateableDateField.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>UpdateableDateField.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'UpdateableDateField.js'<BR/><BR/>
	
</p>

<hr>



<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview">behaviour.gui.updateables.UpdateableDateField = new Class.create();

<span class="comment">/**
 * <span class="attrib">@extends</span>	behaviour.gui.updateables.UpdateableField
 */</span>
Object.extend(behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>, behaviour.gui.updateables.UpdateableField.<span class="reserved">prototype</span>);

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.datePicker;
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.dayDropDown;
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.hourDropDown;
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.minuteDropDown;
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.monthDropDown;
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.title;
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.yearDropDown;

<span class="comment">/**
 */</span>
behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.initialize = <span class="reserved">function</span>(options) {
	var parentMethod = behaviour.gui.updateables.UpdateableField.<span class="reserved">prototype</span>.initialize;
	parentMethod.apply(<span class="reserved">this</span>, arguments);
	
	<span class="reserved">if</span>(!options.initialValue) {
		options.initialValue = new Date();
	}

	<span class="reserved">this</span>.originalValue = new Date(options.initialValue * 1);
	<span class="reserved">this</span>.currentValue = new Date(options.initialValue * 1);
	<span class="reserved">this</span>.displayValue = DateFormatter.getFormattedDate(<span class="reserved">this</span>.currentValue);
	<span class="reserved">this</span>.title = options.pickerTitle;
	<span class="reserved">this</span>.addClass(<span class="literal">"UpdateableDateField"</span>);
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.cancelEdit = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.currentValue.setTime(<span class="reserved">this</span>.originalValue.getTime());
	<span class="reserved">this</span>.displayValue = DateFormatter.getFormattedDate(<span class="reserved">this</span>.currentValue);
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.createEditField = <span class="reserved">function</span>() {
	var dateEditor = DOMUtil.createTextElement(<span class="literal">"a"</span>, Language.get(<span class="literal">"generic"</span>, <span class="literal">"opendatepicker"</span>), {
		href: <span class="literal">"."</span>,
		onclick: <span class="reserved">this</span>.openDatePicker.bindAsEventListener(<span class="reserved">this</span>),
		title: Language.get(<span class="literal">"generic"</span>, <span class="literal">"opendatepicker"</span>),
		className: <span class="literal">"icon datePickerLauncher"</span>
	});

	var node = document.createDocumentFragment();
	node.appendChild(dateEditor);
	
	var dateOrder = DateFormatter.getOrder();
	
	<span class="reserved">for</span>(var i = 0; i &lt; dateOrder.length; i++) {
		<span class="reserved">if</span>(<span class="reserved">this</span>[<span class="literal">"generate"</span> + dateOrder[i]]) {
			node.appendChild(<span class="reserved">this</span>[<span class="literal">"generate"</span> + dateOrder[i]].call(<span class="reserved">this</span>));
		} <span class="reserved">else</span> {
			Log.info(<span class="literal">"Invalid date atom - "</span> + dateOrder[i]);
		}
	}
	
	<span class="reserved">return</span> node;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.openDatePicker = <span class="reserved">function</span>(event) {
	var element = Event.element(event);
	element.blur();
	
	<span class="reserved">if</span>(!<span class="reserved">this</span>.datePicker) {
		var windowSize = BehaviourUtil.getWindowSize();
		
		<span class="comment">//this.datePicker = new behaviour.gui.DatePicker(this.controller, this, this.title, this.currentValue, Event.pointerX(event), Event.pointerY(event));</span>
		<span class="reserved">this</span>.datePicker = new behaviour.gui.DatePicker(<span class="reserved">this</span>, <span class="reserved">this</span>.title, <span class="reserved">this</span>.currentValue, (windowSize.width/2)-82, (windowSize.height/2)-90);
	}
	
	<span class="reserved">return</span> false;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.datePicked = <span class="reserved">function</span>(pickedDate) {
	<span class="reserved">if</span>(pickedDate instanceof Date) {
		<span class="comment">//Log.info("Old date = " + this.date);</span>
		<span class="reserved">this</span>.currentValue.setTime(pickedDate.getTime());
		<span class="reserved">this</span>.render();
		<span class="comment">//Log.info("New date = " + this.date);</span>
	}
	
	<span class="reserved">this</span>.datePicker = null;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateDay = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.dayDropDown = document.createElement(<span class="literal">"select"</span>);
	<span class="reserved">this</span>.dayDropDown.onchange = <span class="reserved">this</span>.updateLocalValue.bindAsEventListener(<span class="reserved">this</span>);
	<span class="reserved">this</span>.dayDropDown.name = <span class="literal">"days"</span>;
	
	var daysInMonth = <span class="reserved">this</span>.getDaysInMonth(<span class="reserved">this</span>.currentValue);
	
	<span class="reserved">for</span>(var i = 1; i &lt;= daysInMonth; i++) {
		var option = document.createElement(<span class="literal">"option"</span>);
		option.value = i;
		option.appendChild(document.createTextNode(i));
		
		<span class="reserved">if</span>(i == <span class="reserved">this</span>.currentValue.getDate()) {
			option.selected = <span class="literal">"selected"</span>;
		}
		
		<span class="reserved">this</span>.dayDropDown.appendChild(option);
	}
	
	<span class="reserved">this</span>.dayDropDown.disabled = <span class="reserved">this</span>.disabled;
	
	<span class="reserved">return</span> <span class="reserved">this</span>.dayDropDown;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateDateSeperator = <span class="reserved">function</span>() {
	<span class="reserved">return</span> document.createTextNode(DateFormatter.getDateSeperator());
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateEmptySpace = <span class="reserved">function</span>() {
	<span class="reserved">return</span> document.createTextNode(<span class="literal">" "</span>);
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateHour = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.hourDropDown = document.createElement(<span class="literal">"select"</span>);
	<span class="reserved">this</span>.hourDropDown.onchange = <span class="reserved">this</span>.updateLocalValue.bindAsEventListener(<span class="reserved">this</span>);
	<span class="reserved">this</span>.hourDropDown.name = <span class="literal">"hours"</span>;
	
	<span class="reserved">for</span>(var i = 1; i &lt; 24; i++) {
		var option = document.createElement(<span class="literal">"option"</span>);
		option.value = i;
		option.appendChild(document.createTextNode((i &lt; 10 ? <span class="literal">"0"</span> + i : i)));
		
		<span class="reserved">if</span>(i == <span class="reserved">this</span>.currentValue.getHours()) {
			option.selected = true;
		}
		
		<span class="reserved">this</span>.hourDropDown.appendChild(option);
	}
	
	<span class="reserved">this</span>.hourDropDown.disabled = <span class="reserved">this</span>.disabled;
	
	<span class="reserved">return</span> <span class="reserved">this</span>.hourDropDown;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateMinute = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.minuteDropDown = document.createElement(<span class="literal">"select"</span>);
	<span class="reserved">this</span>.minuteDropDown.onchange = <span class="reserved">this</span>.updateLocalValue.bindAsEventListener(<span class="reserved">this</span>);
	<span class="reserved">this</span>.minuteDropDown.name = <span class="literal">"minutes"</span>;
	
	<span class="reserved">for</span>(var i = 0; i &lt; 60; i += 15) {
		var option = document.createElement(<span class="literal">"option"</span>);
		option.value = i;
		option.appendChild(document.createTextNode((i &lt; 10 ? <span class="literal">"0"</span> + i : i)));
		
		<span class="reserved">if</span>(i == <span class="reserved">this</span>.currentValue.getMinutes()) {
			option.selected = true;
		}
		
		<span class="reserved">this</span>.minuteDropDown.appendChild(option);
	}
	
	<span class="reserved">this</span>.minuteDropDown.disabled = <span class="reserved">this</span>.disabled;
	
	<span class="reserved">return</span> <span class="reserved">this</span>.minuteDropDown;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateMonth = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.monthDropDown = document.createElement(<span class="literal">"select"</span>);
	<span class="reserved">this</span>.monthDropDown.onchange = <span class="reserved">this</span>.updateLocalValue.bindAsEventListener(<span class="reserved">this</span>);
	<span class="reserved">this</span>.monthDropDown.name = <span class="literal">"months"</span>;
	
	<span class="reserved">for</span>(var i = 0; i &lt; 12; i++) {
		var option = document.createElement(<span class="literal">"option"</span>);
		option.value = i;
		option.appendChild(document.createTextNode(Language.get(<span class="literal">"generic"</span>, <span class="literal">"date"</span>, <span class="literal">"months-"</span> + i).substr(0, 3)));
		
		<span class="reserved">if</span>(i == <span class="reserved">this</span>.currentValue.getMonth() || <span class="literal">"0"</span> + i == <span class="reserved">this</span>.currentValue.getMonth()) {
			option.selected = true;
		}
		
		<span class="reserved">this</span>.monthDropDown.appendChild(option);
	}
	
	<span class="reserved">this</span>.monthDropDown.disabled = <span class="reserved">this</span>.disabled;
	
	<span class="reserved">return</span> <span class="reserved">this</span>.monthDropDown;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateTimeSeperator = <span class="reserved">function</span>() {
	<span class="reserved">return</span> document.createTextNode(DateFormatter.getTimeSeperator());
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.generateYear = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.yearDropDown = document.createElement(<span class="literal">"select"</span>);
	<span class="reserved">this</span>.yearDropDown.onchange = <span class="reserved">this</span>.updateLocalValue.bindAsEventListener(<span class="reserved">this</span>);
	<span class="reserved">this</span>.yearDropDown.name = <span class="literal">"years"</span>;
	var currentDate = new Date();
	
	<span class="reserved">for</span>(var i = currentDate.getFullYear() - 5; i &lt; (currentDate.getFullYear() + 10); i++) {
		var option = document.createElement(<span class="literal">"option"</span>);
		option.value = i;
		option.appendChild(document.createTextNode(i));
		
		<span class="reserved">if</span>(i == <span class="reserved">this</span>.currentValue.getFullYear()) {
			option.selected = true;
		}
		
		<span class="reserved">this</span>.yearDropDown.appendChild(option);
	}
	
	<span class="reserved">this</span>.yearDropDown.disabled = <span class="reserved">this</span>.disabled;
	
	<span class="reserved">return</span> <span class="reserved">this</span>.yearDropDown;
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.getDaysInMonth = <span class="reserved">function</span>(date) {
	<span class="reserved">return</span> 32 - new Date(date.getFullYear(), date.getMonth(), 32).getDate();
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.getValue = <span class="reserved">function</span>() {
	<span class="reserved">return</span> <span class="reserved">this</span>.currentValue.getTime();
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.saveEdit = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.originalValue.setTime(<span class="reserved">this</span>.currentValue.getTime());
	<span class="reserved">this</span>.displayValue = DateFormatter.getFormattedDate(<span class="reserved">this</span>.currentValue);
}

behaviour.gui.updateables.UpdateableDateField.<span class="reserved">prototype</span>.updateLocalValue = <span class="reserved">function</span>(event) {
	<span class="comment">// make sure we don't go off the end of the month - ie. select july 31 then select february</span>
	var daysInCurrentMonth = <span class="reserved">this</span>.getDaysInMonth(<span class="reserved">this</span>.currentValue);
	var daysInNewMonth = <span class="reserved">this</span>.getDaysInMonth(new Date(Form.Element.getValue(<span class="reserved">this</span>.yearDropDown), Form.Element.getValue(<span class="reserved">this</span>.monthDropDown)));
	
	<span class="reserved">if</span>(daysInNewMonth &lt; daysInCurrentMonth) {
		var day = daysInNewMonth;
	} <span class="reserved">else</span> {
		var day = Form.Element.getValue(<span class="reserved">this</span>.dayDropDown);
	}
	
	<span class="reserved">this</span>.currentValue = new Date(Form.Element.getValue(<span class="reserved">this</span>.yearDropDown), Form.Element.getValue(<span class="reserved">this</span>.monthDropDown), day, Form.Element.getValue(<span class="reserved">this</span>.hourDropDown), Form.Element.getValue(<span class="reserved">this</span>.minuteDropDown), 0);	
	<span class="reserved">this</span>.render();
}
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Tue Jul 17 12:45:55 2007</div>
</body>
</html>

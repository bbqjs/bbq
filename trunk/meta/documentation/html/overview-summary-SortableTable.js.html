<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="SortableTable.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>SortableTable.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'SortableTable.js'<BR/><BR/>
	
</p>

<hr>



<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/**
 * SortableTable
 * 
 * This class allows creation of tables displaying lists of data.
 * 
 */</span>
behaviour.gui.table.SortableTable = new Class.create();

<span class="comment">// extends SortableGUIWidget</span>
Object.extend(behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>, behaviour.gui.SortableGUIWidget.<span class="reserved">prototype</span>);

behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._tableHead;
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._callBacks;
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._boundCallBacks;
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.selectedElementID;
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.sortedByColumnIndex;
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.sortedByDirection;

<span class="comment">/**
 * It supports the following options:
 * 
 * options = {
 * 		entities: Array								An array of objects to build the table from	
 * 		entityID: String								The name of the id field of the objects above
 * 		listItemsKey: String						Use object field with the passed name as entities
 * 		startSorted: {
 * 			column:	int				Which column to sort by - default 0
 * 			direction : string	Sort direction: default ASC
 * 		},
 * 		columnData = [{
 * 			text: mixed								Either a string which references a property on the current entity or a function that conforms to function(entity, index) and returns a Node
 * 			shorten: int								The maximum length of the field
 * 			sortField: string						The name of the object property to sort this column by.  Omit for a non-sortable column.
 * 	}, {...}, {...}]
 * }
 * 
 * N.B. The down state referred to below means that a specified tr element will have a CSS class titled "down" applied to it.
 * 
 * <span class="attrib">@param</span>	Object		options					Options for the whole table
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.initialize = <span class="reserved">function</span>() {
	var parentMethod = behaviour.gui.SortableGUIWidget.<span class="reserved">prototype</span>.initialize;
	parentMethod.apply(<span class="reserved">this</span>, arguments);
	
	<span class="reserved">this</span>.setRootNode(document.createElement(<span class="literal">"table"</span>));
	<span class="reserved">this</span>.addClass(<span class="literal">"SortableTable"</span>);
	
	<span class="reserved">this</span>._callBacks = {};
	<span class="reserved">this</span>.options.entityID = <span class="reserved">this</span>.options.entityID ? <span class="reserved">this</span>.options.entityID : <span class="literal">"id"</span>;
	
	<span class="reserved">this</span>._boundCallBacks = {
		onclick: <span class="reserved">this</span>._itemClicked.bindAsEventListener(<span class="reserved">this</span>),
		ondblclick: <span class="reserved">this</span>._itemDoubleClicked.bindAsEventListener(<span class="reserved">this</span>)
	}
}

<span class="comment">/**
  Overrides ancestor method in order to sort data after the ancestor method calls render();
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.appendTo = <span class="reserved">function</span>(pageNode) {
	var parentMethod = behaviour.gui.GUIWidget.<span class="reserved">prototype</span>.appendTo;
	parentMethod.apply(<span class="reserved">this</span>, arguments);
	
	<span class="reserved">if</span>(<span class="reserved">this</span>.options.startSorted) {
		<span class="reserved">if</span>(<span class="reserved">this</span>.options.startSorted.direction) {
			<span class="reserved">this</span>.sortedByDirection = <span class="reserved">this</span>.options.startSorted.direction == <span class="literal">"DESC"</span> ? <span class="literal">"ASC"</span> : <span class="literal">"DESC"</span>;
		}
		
		<span class="reserved">this</span>.sortByIndex(<span class="reserved">this</span>.options.startSortedBy ? <span class="reserved">this</span>.options.startSortedBy : 0);
	} <span class="reserved">else</span> {
		<span class="reserved">this</span>.sortByIndex(0);
	}
}

<span class="comment">/**
 * Parses through the entity list and creates the table
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.render = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.empty();
	try {	
	var headerRow = document.createElement(<span class="literal">"tr"</span>);
	
	<span class="reserved">for</span>(var i = 0; i &lt; <span class="reserved">this</span>.options.headerRows.length; i++) {
		var cell = document.createElement(<span class="literal">"th"</span>);
		
		<span class="reserved">if</span>(!<span class="reserved">this</span>.options.columnData[i][<span class="literal">"sortField"</span>] || typeof(<span class="reserved">this</span>.options.columnData[i][<span class="literal">"sortField"</span>]) == <span class="literal">"undefined"</span>) {
			<span class="comment">// not a header that the data is supposed to be sortable by</span>
			cell.appendChild(document.createTextNode(<span class="reserved">this</span>.options.headerRows[i]));
		} <span class="reserved">else</span> {
			<span class="comment">// create link that when clicked sorts the table</span>
			var anchor = DOMUtil.createTextElement(<span class="literal">"a"</span>, <span class="reserved">this</span>.options.headerRows[i], {href: <span class="literal">"."</span>, onclick: <span class="reserved">this</span>.sortByColumn.bindAsEventListener(<span class="reserved">this</span>)});
			
			<span class="comment">// are we currently sorted by this header?</span>
			<span class="reserved">if</span>(<span class="reserved">this</span>.sortedByColumnIndex == i) {
				DOMUtil.addClass(anchor, <span class="literal">"sortedBy"</span> + <span class="reserved">this</span>.sortedByDirection);
			}
			
			cell.appendChild(anchor);
		}
		
		<span class="reserved">if</span>(<span class="reserved">this</span>.options.columnData[i] &amp;&amp; <span class="reserved">this</span>.options.columnData[i][<span class="literal">"iconColumn"</span>]) {
			DOMUtil.addClass(cell, <span class="literal">"iconColumnHeader"</span>);
		}
		
		<span class="comment">// add cell to row</span>
		headerRow.appendChild(cell);
	}
	
	<span class="reserved">this</span>._tableHead = document.createElement(<span class="literal">"thead"</span>);
	<span class="reserved">this</span>._tableHead.appendChild(headerRow);
	<span class="reserved">this</span>.appendChild(<span class="reserved">this</span>._tableHead);
	
	<span class="comment">// updates data needed to build the table nodes</span>
	var entityGroup = <span class="reserved">this</span>.getEntityGroup();
	
	var tableBody = document.createElement(<span class="literal">"tbody"</span>);
	<span class="reserved">this</span>.appendChild(tableBody);
		
	<span class="reserved">for</span>(var i = 0; i &lt; entityGroup.length; i++) {
		var entity = entityGroup[i];
		var row = document.createElement(<span class="literal">"tr"</span>);
		row.owningEntity = entity;
		tableBody.appendChild(row);
		
		<span class="reserved">if</span>(i % 2 == 0) {
			DOMUtil.addClass(row, <span class="literal">"oddRow"</span>);
		} <span class="reserved">else</span> {
			DOMUtil.addClass(row, <span class="literal">"evenRow"</span>);
		}
		
		<span class="comment">// set previously selected item down</span>
		<span class="reserved">if</span>(entity[<span class="reserved">this</span>.options.entityID] == <span class="reserved">this</span>.selectedElementID) {
			DOMUtil.addClass(row, <span class="literal">"down"</span>);
		}
		
		<span class="reserved">for</span>(var n = 0; n &lt; <span class="reserved">this</span>.options.columnData.length; n++) { <span class="comment">// process one entity (eg. one row)</span>
			var cell = document.createElement(<span class="literal">"td"</span>);
			row.appendChild(cell);
			
			<span class="reserved">if</span>(n == 0) {
				DOMUtil.addClass(cell, <span class="literal">"firstColumn"</span>);
			}
			
			<span class="reserved">if</span>(<span class="reserved">this</span>.options.columnData[n][<span class="literal">"text"</span>] instanceof Function) {
				var cellContent = <span class="reserved">this</span>.options.columnData[n][<span class="literal">"text"</span>].call(<span class="reserved">this</span>, entity, n, cell);
								
				<span class="reserved">if</span>(cellContent) {
					<span class="reserved">this</span>._processCallbacks(cellContent, entity, n);
					cell.appendChild(cellContent);
				}
			} <span class="reserved">else</span> {
				var text = <span class="reserved">this</span>.getText(entity, <span class="reserved">this</span>.options.columnData[n][<span class="literal">"text"</span>]);
				cell.appendChild(document.createTextNode(text ? text : <span class="literal">" "</span>));
			}
			
			cell.owningEntity = entity;
		}
	}
	
	} catch(e) {
		Log.dumpObject(e);
	}
}

<span class="comment">/**
 * Stores onclick and ondblclick so we can call them after setting the down state of the row
 * 
 * <span class="attrib">@private</span>
 * <span class="attrib">@param</span>	{Node}	node	A node that we suspect has onclick, etc attributes defined on it
 * <span class="attrib">@param</span>	{Object}	entity	The entity that the row was made from that the node is from
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._processCallbacks = <span class="reserved">function</span>(node, entity, columnIndex) {
	<span class="reserved">if</span>(node) {
		node.columnIndex = columnIndex;
		
		<span class="reserved">for</span>(var key in {onclick: <span class="literal">""</span>, ondblclick: <span class="literal">""</span>}) { <span class="comment">// check for onclick and ondblclick</span>
			<span class="reserved">if</span>(node[key]) { <span class="comment">// if it's defined</span>
				<span class="reserved">if</span>(!<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]]) { <span class="comment">// make sure the callback holder is defined</span>
					<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]] = {};
				}
				
				<span class="reserved">if</span>(!<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex]) { <span class="comment">// make sure the callback holder is defined</span>
					<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex] = {};
				}
				
				<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex][key] = node[key]; <span class="comment">// store the callback for calling later</span>
				node[key] = <span class="reserved">this</span>._boundCallBacks[key]; <span class="comment">// replace it with our generic callback</span>
			}
		}
	}
}

<span class="comment">/**
 * Sets the down state on a row clicked by an user
 * 
 * <span class="attrib">@private</span>
 * <span class="attrib">@param</span>	Event	An onclick event
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._itemClicked = <span class="reserved">function</span>(event) {
	<span class="reserved">this</span>._processEvent(BehaviourUtil.clearFocus(event), <span class="literal">"onclick"</span>);
	
	<span class="reserved">return</span> false;
}

behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._itemDoubleClicked = <span class="reserved">function</span>(event) {
	<span class="reserved">this</span>._processEvent(BehaviourUtil.clearFocus(event), <span class="literal">"ondblclick"</span>);
	
	<span class="reserved">return</span> false;
}

<span class="comment">/**
 * <span class="attrib">@private</span>
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._processEvent = <span class="reserved">function</span>(node, eventName) {
	<span class="reserved">this</span>._setItemDown(node);
	
	var entity = node.parentNode.owningEntity;
	var columnIndex = node.columnIndex;
	<span class="reserved">this</span>.selectedElementID = entity[<span class="reserved">this</span>.options.entityID];
	
	<span class="reserved">if</span>(FocusWatcher) {
		FocusWatcher.setKeypressCallbackObject(<span class="reserved">this</span>);
	}
	
	<span class="reserved">if</span>(<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]] &amp;&amp; <span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex] &amp;&amp; <span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex][eventName] &amp;&amp; <span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex][eventName] instanceof Function) {
		<span class="reserved">this</span>._callBacks[entity[<span class="reserved">this</span>.options.entityID]][columnIndex][eventName].call(<span class="reserved">this</span>, entity);
	}
}

<span class="comment">/**
 * Sets the down state on the row containing the passed element
 * 
 * <span class="attrib">@private</span>
 * <span class="attrib">@param</span>	Node	Typically an anchor node
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._setItemDown = <span class="reserved">function</span>(element) {
	<span class="reserved">this</span>.clearDown();
	
	var row = element.parentNode.parentNode;
	DOMUtil.addClass(row, <span class="literal">"down"</span>);
}

<span class="comment">/**
 * Removes the down state from all table rows
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.clearDown = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.selectedElementID = null;
	DOMUtil.removeClass(<span class="reserved">this</span>.rootNode, <span class="literal">"down"</span>, true);
}

<span class="comment">/**
 * Sets the down state on the row created from the entity with the passed id
 * 
 * <span class="attrib">@param</span>	mixed	The id of an entity in the array passed to the constructor of this object
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.setItemWithIdDown = <span class="reserved">function</span>(id) {
	<span class="reserved">this</span>.clearDown();
	
	Log.info(<span class="literal">"Looking for : "</span> + <span class="reserved">this</span>.options.columnData[0][<span class="literal">"htmlID"</span>] + <span class="literal">"_"</span> + id);
	
	var row = $(<span class="reserved">this</span>.options.columnData[0][<span class="literal">"htmlID"</span>] + <span class="literal">"_"</span> + id).parentNode.parentNode;
	<span class="reserved">this</span>.selectedElementID = id;
	DOMUtil.addClass(row, <span class="literal">"down"</span>);
	
	Log.info(<span class="literal">"class is now "</span> + row.className);
}

<span class="comment">/**
 * Returns either the value of the entity property using text as a key or text itself.
 * 
 * So getText({name: "alex"}, "name") would return "alex" but getText({name: "alex"}, "age") would return "age".  
 * 
 * If entityID has . characters in it, this method will step down into entity to find the key, so 
 * getText({name: "alex", innerObject : {name: "bob"}}, "innerObject.bob") would return "bob"
 * 
 * <span class="attrib">@param</span>	Object		entity
 * <span class="attrib">@param</span>	String		text
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.getText = <span class="reserved">function</span>(entity, text) {
	<span class="reserved">if</span>(text.search(/(\.)/) &gt; -1) {
		<span class="reserved">return</span> <span class="reserved">this</span>._findIt(entity, text.split(<span class="literal">"."</span>));
	} <span class="reserved">else</span> <span class="reserved">if</span>(entity[text]) {
		<span class="reserved">return</span> entity[text];
	}
	
	<span class="reserved">return</span> text;
}

<span class="comment">/**
 * Returns the ID of the entity.  If entityID has . characters in it, this method will step down into entity to find the key.
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.getEntityID = <span class="reserved">function</span>(entity, entityID) {
	<span class="reserved">if</span>(entityID.search(/\./)) {
		<span class="reserved">return</span> <span class="reserved">this</span>._findIt(entity, entityID.split(<span class="literal">"."</span>));
	}
	
	<span class="reserved">return</span> entity[entityID];
}

<span class="comment">/**
 * Called by getText and getEntityID to step down into objects.
 * 
 * <span class="attrib">@private</span>
 * <span class="attrib">@param</span>	{Object}	entity
 * <span class="attrib">@param</span>	{Array}	keys
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>._findIt = <span class="reserved">function</span>(entity, keys) {
	var output = entity[keys[0]];
		
	<span class="reserved">for</span>(var i = 1; i &lt; keys.length; i++) {
		output = output[keys[i]];
	}
		
	<span class="reserved">return</span> output;
}

<span class="comment">/**
 * Sets the appropriate class name on the clicked column header and calls sortByIndex to do the sorting
 * 
 * <span class="attrib">@param</span>	{Event}	event
 * <span class="attrib">@return</span>	{boolean}
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.sortByColumn = <span class="reserved">function</span>(event) {
	var element = BehaviourUtil.clearFocus(event);
	
	DOMUtil.removeClass(<span class="reserved">this</span>._tableHead, <span class="literal">"sortedByASC"</span>, true);
	DOMUtil.removeClass(<span class="reserved">this</span>._tableHead, <span class="literal">"sortedByDESC"</span>, true);
	
	var headerIndex = -1;
	headerArray = <span class="reserved">this</span>.rootNode.getElementsByTagName(<span class="literal">"th"</span>);
	
	<span class="comment">// get column index</span>
	<span class="reserved">for</span>(var i = 0; i &lt; headerArray.length; i++) {
		<span class="reserved">if</span>(headerArray[i].getElementsByTagName(<span class="literal">"a"</span>)[0] == element) {
			headerIndex = i;
			break;
		}
	}
		
	<span class="reserved">this</span>.sortByIndex(headerIndex);
	
	<span class="reserved">return</span> false;
}

<span class="comment">/**
 * Gets the entities to make the table from
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.getEntityGroup = <span class="reserved">function</span>() {
	<span class="reserved">if</span>(<span class="reserved">this</span>.options[<span class="literal">"listItemsKey"</span>]) {
		<span class="reserved">return</span> <span class="reserved">this</span>.options.entities[<span class="reserved">this</span>.options[<span class="literal">"listItemsKey"</span>]];
	}
	
	<span class="reserved">return</span> <span class="reserved">this</span>.options.entities;
}

<span class="comment">/**
 * Sorts the table entries by this.sortedByColumnIndex or a specified column - 
 * 0 = first column, 1 = second column, etc
 * 
 * <span class="attrib">@param</span>	{int}	index
 * <span class="attrib">@return</span>	void
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.sortByIndex = <span class="reserved">function</span>(index) {
	<span class="reserved">if</span>(index == -1) {
		<span class="reserved">return</span>;
	}
	
	<span class="reserved">if</span>(<span class="reserved">this</span>.sortedByColumnIndex == index) {
		<span class="reserved">this</span>.sortedByDirection = (<span class="reserved">this</span>.sortedByDirection == <span class="literal">"DESC"</span> ? <span class="literal">"ASC"</span> : <span class="literal">"DESC"</span>);
	} <span class="reserved">else</span> {
		<span class="reserved">this</span>.sortedByDirection = <span class="literal">"DESC"</span>;
	}
	
	Log.info(<span class="literal">"sorting by "</span> + <span class="reserved">this</span>.sortedByDirection);
	
	<span class="reserved">this</span>.sortedByColumnIndex = index;
	<span class="reserved">this</span>.currentSortKey = <span class="reserved">this</span>.options.columnData[<span class="reserved">this</span>.sortedByColumnIndex][<span class="literal">"sortField"</span>];
	
	var entityGroup = <span class="reserved">this</span>.getEntityGroup();
	
	<span class="reserved">if</span>(<span class="reserved">this</span>.sortedByDirection == <span class="literal">"ASC"</span>) {
		entityGroup.sort(<span class="reserved">this</span>.ascSortFunction.bind(<span class="reserved">this</span>));
	} <span class="reserved">else</span> {
		entityGroup.sort(<span class="reserved">this</span>.descSortFunction.bind(<span class="reserved">this</span>));
	}
	
	<span class="reserved">this</span>.render();
	<span class="reserved">this</span>._processSortWatchers();
}

<span class="comment">/**
 * Returns the ID of the first item in the entity array
 * 
 * <span class="attrib">@return</span>	{String}
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.getFirstItem = <span class="reserved">function</span>() {
	var entityGroup = <span class="reserved">this</span>.getEntityGroup();
	
	<span class="reserved">if</span>(entityGroup instanceof Array) {
		<span class="reserved">return</span> entityGroup[0];
	}
}

<span class="comment">/**
 * Sets the down state on the row formed from the passed entity.  Or, more correctly, sets the down state on the row formed from
 * the entity originally passed to the constructor with an identification field that matches the entity passed to this method.
 * 
 * <span class="attrib">@param</span>	{Object}		The entity whose row to set to the down state
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.setEntityDown = <span class="reserved">function</span>(entity) {
	<span class="reserved">if</span>(entity) {
		<span class="reserved">this</span>.clearDown();
		
		$A(<span class="reserved">this</span>.rootNode.getElementsByTagName(<span class="literal">"tr"</span>)).each(<span class="reserved">function</span>(row){
			<span class="reserved">if</span>(row.owningEntity &amp;&amp; row.owningEntity[<span class="reserved">this</span>.options.entityID] &amp;&amp; row.owningEntity[<span class="reserved">this</span>.options.entityID] == entity[<span class="reserved">this</span>.options.entityID]) {
				DOMUtil.addClass(row, <span class="literal">"down"</span>);
				<span class="reserved">this</span>.selectedElementID = entity[<span class="reserved">this</span>.options.entityID];
			}
		}.bind(<span class="reserved">this</span>));
	}
}

<span class="comment">/**
 * Removes a row from th table.  NB. this will destructively affect the entity array passed to this object's constructor
 * 
 * <span class="attrib">@param</span>	{Object}		The entity to remove
 * <span class="attrib">@param</span>	{bool}			Whether or not to select the first item in the table if the currently selected entity is the one we are deleting
 */</span>
behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.removeEntity = <span class="reserved">function</span>(entity, selectNew) {
	<span class="reserved">this</span>.entities = <span class="reserved">this</span>.entities.findAll(<span class="reserved">function</span>(element, index){<span class="reserved">return</span> element.id != entity.id});
	<span class="reserved">this</span>.render();
}

behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.acceptFocus = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.addClass(<span class="literal">"hasFocus"</span>);
}

behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.loseFocus = <span class="reserved">function</span>() {
	<span class="reserved">this</span>.removeClass(<span class="literal">"hasFocus"</span>);
}

behaviour.gui.table.SortableTable.<span class="reserved">prototype</span>.processKeypress = <span class="reserved">function</span>(event) {
	var nextEntity = false;
	var foundEntity = false;
	
	<span class="comment">// process keypress</span>
	<span class="reserved">if</span>(event.keyCode == Event.KEY_DOWN) { <span class="comment">// if we can go one further down the list, do it but skip the contents of closed folders</span>
		$A(<span class="reserved">this</span>.rootNode.getElementsByTagName(<span class="literal">"tr"</span>)).each(<span class="reserved">function</span>(row){
			<span class="reserved">if</span>(foundEntity &amp;&amp; !nextEntity) {
				nextEntity = row.owningEntity;
			}
			
			<span class="reserved">if</span>(row.owningEntity &amp;&amp; row.owningEntity[<span class="reserved">this</span>.options.entityID] &amp;&amp; row.owningEntity[<span class="reserved">this</span>.options.entityID] == <span class="reserved">this</span>.selectedElementID) {
				foundEntity = true;
			}
		}.bind(<span class="reserved">this</span>));
	} <span class="reserved">else</span> <span class="reserved">if</span>(event.keyCode == Event.KEY_UP) {  <span class="comment">// if we can go one further up the list, do it but skip the contents of closed folders</span>
		$A(<span class="reserved">this</span>.rootNode.getElementsByTagName(<span class="literal">"tr"</span>)).each(<span class="reserved">function</span>(row){
			<span class="reserved">if</span>(row.owningEntity &amp;&amp; row.owningEntity[<span class="reserved">this</span>.options.entityID] &amp;&amp; row.owningEntity[<span class="reserved">this</span>.options.entityID] == <span class="reserved">this</span>.selectedElementID) {
				foundEntity = true;
				throw $break;
			}
			
			nextEntity = row.owningEntity;
		}.bind(<span class="reserved">this</span>));
	}
	
	<span class="reserved">if</span>(nextEntity) {
		<span class="reserved">this</span>.setEntityDown(nextEntity);
		
		<span class="reserved">if</span>(<span class="reserved">this</span>._callBacks[nextEntity[<span class="reserved">this</span>.options.entityID]] &amp;&amp; <span class="reserved">this</span>._callBacks[nextEntity[<span class="reserved">this</span>.options.entityID]][0] &amp;&amp; <span class="reserved">this</span>._callBacks[nextEntity[<span class="reserved">this</span>.options.entityID]][0][<span class="literal">"onclick"</span>] &amp;&amp; <span class="reserved">this</span>._callBacks[nextEntity[<span class="reserved">this</span>.options.entityID]][0][<span class="literal">"onclick"</span>] instanceof Function) {
			<span class="reserved">this</span>._callBacks[nextEntity[<span class="reserved">this</span>.options.entityID]][0][<span class="literal">"onclick"</span>].call(<span class="reserved">this</span>, nextEntity);
		}
	}
	
	<span class="reserved">return</span> true;
}</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Tue Jul 17 12:45:55 2007</div>
</body>
</html>

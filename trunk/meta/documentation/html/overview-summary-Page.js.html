<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Page.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Page.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'Page.js'<BR/><BR/>
	
</p>

<hr>



<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview">behaviour.page.Page = new Class.create();

behaviour.page.Page.<span class="reserved">prototype</span>.language;
behaviour.page.Page.<span class="reserved">prototype</span>.config;
behaviour.page.Page.<span class="reserved">prototype</span>.backButtonFixer;
behaviour.page.Page.<span class="reserved">prototype</span>.user;
behaviour.page.Page.<span class="reserved">prototype</span>.dateFormatter;
behaviour.page.Page.<span class="reserved">prototype</span>.minWidth = 1000;
behaviour.page.Page.<span class="reserved">prototype</span>.notificationArea;

behaviour.page.Page.<span class="reserved">prototype</span>.loadingData = false;
behaviour.page.Page.<span class="reserved">prototype</span>.dataLoaded = false;
behaviour.page.Page.<span class="reserved">prototype</span>.firstDataCall = true;
behaviour.page.Page.<span class="reserved">prototype</span>.dataCallMethod;
behaviour.page.Page.<span class="reserved">prototype</span>.dataCallArgs;
behaviour.page.Page.<span class="reserved">prototype</span>.dataCallMethodCalled = false;
behaviour.page.Page.<span class="reserved">prototype</span>.waitForDataLoadInterval;

behaviour.page.Page.<span class="reserved">prototype</span>.modalLayer;
behaviour.page.Page.<span class="reserved">prototype</span>.modalLayerContents;

<span class="comment">/**
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.initialize = <span class="reserved">function</span>() {
	<span class="comment">//Log.info("Page constructor");</span>
	
	Browser.detect();
	DOMUtil.checkDOM();
	
	Event.observe(window, <span class="literal">"resize"</span>, <span class="reserved">this</span>.resizePanels.bindAsEventListener(<span class="reserved">this</span>));
	
	<span class="reserved">this</span>.createLayoutManager();
	<span class="reserved">this</span>.constructed();
}

<span class="comment">/**
 * Creates an object to handle adjusting the page layout when it's resized
 * 
 * Concrete subclasses should override this method
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.createLayoutManager = <span class="reserved">function</span>() {
	Log.warn(<span class="literal">"Default createLayoutManager() called"</span>);
}

<span class="comment">/**
 * This method allows the bookmarking of pages.
 * 
 * When it is first invoked, it checks to see if the page's data set has been loaded.  If it has then it calls the passed function with the passed
 * arguments.  If it has not loaded then it stores the function and arguments and sets a timeout to check the state of the data again.
 * 
 * N.B.  It's up to children of this class to set the dataLoaded member variable as they see fit.
 * 
 * <span class="attrib">@param</span>	{Function}	methodToCall	The method to call when the data has loaded
 * <span class="attrib">@param</span>	{Array}	args	Arguments to pass to the methodToCall function
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.checkDataLoaded = <span class="reserved">function</span>(methodToCall, args) {
	<span class="reserved">if</span>(!<span class="reserved">this</span>.dataLoaded) { <span class="comment">// initial data set has not loaded</span>
		<span class="comment">//Log.info("Data not loaded");</span>
		
		<span class="reserved">if</span>(<span class="reserved">this</span>.firstDataCall) { <span class="comment">// this is the first time this method has been called</span>
			<span class="comment">//Log.info("Storing method to call later");</span>
			
			<span class="comment">// store the calling method and it's arguments for later</span>
			<span class="reserved">this</span>.dataCallMethod = methodToCall;
			<span class="reserved">this</span>.dataCallArgs = args;
			<span class="reserved">this</span>.dataCallMethodCalled = false;
			
			<span class="comment">/*  make sure we don't overwrite the data set above - this is due to an undocumented feature in 
			 *   FireFox where any set(timeout|interval) call back has an extra argument of how many msecs out
			 *   the call is.
			 */</span>
			<span class="reserved">this</span>.firstDataCall = false;
		}
		
		<span class="comment">//Log.info("Setting timeout to wait for data to load");</span>
		setTimeout(<span class="reserved">this</span>.checkDataLoaded.bind(<span class="reserved">this</span>), 500);
	} <span class="reserved">else</span> <span class="reserved">if</span>(methodToCall instanceof Function) {
		<span class="comment">//Log.info("Data loaded, calling passed method");</span>
		methodToCall.apply(<span class="reserved">this</span>, args);
		
		<span class="reserved">this</span>.firstDataCall = true;
	} <span class="reserved">else</span> { <span class="comment">// initial data set has loaded</span>
		<span class="comment">//Log.info("Data loaded, calling stored method");</span>
		<span class="reserved">this</span>.dataCallMethod.apply(<span class="reserved">this</span>, <span class="reserved">this</span>.dataCallArgs);
		<span class="reserved">this</span>.firstDataCall = true;
	}
}

behaviour.page.Page.<span class="reserved">prototype</span>.get = <span class="reserved">function</span>(objectArray, key, expectedValue) {
	<span class="reserved">if</span>(objectArray instanceof Array) {
		<span class="reserved">for</span>(var i = 0; i &lt; objectArray.length; i++) {
			var object = objectArray[i];
			
			<span class="reserved">if</span>(object[key] == expectedValue) {
				<span class="reserved">return</span> object;
			}
		}
	} <span class="reserved">else</span> <span class="reserved">if</span>(objectArray instanceof Object) {
		<span class="reserved">for</span>(object in objectArray) {
			<span class="reserved">if</span>(objectArray[object][key] == expectedValue) {
				<span class="reserved">return</span> objectArray[object];
			}
		}
	} <span class="reserved">else</span> {
		Log.warn(<span class="literal">"Invalid objectArray handed to Page.get"</span>);
	}
}

<span class="comment">// returns a requested bit of language</span>
behaviour.page.Page.<span class="reserved">prototype</span>.getLanguageArray = <span class="reserved">function</span>()
	{
	 var output = new Array();
	
	<span class="reserved">if</span>(<span class="reserved">this</span>.language)
		{
		var expected = arguments[0];
		var args = new Array();
		
		<span class="reserved">for</span>(var i = 1; i &lt; arguments.length; i++)
			{
			args[args.length] = arguments[i];
			}
		
		var key = args.last();
		
		<span class="reserved">for</span>(var i = 0; i &lt; expected; i++)
			{
			args[args.length - 1] = key + i;
			output[i] = <span class="reserved">this</span>.getLanguage.apply(<span class="reserved">this</span>, args);
			}
		}
	
	<span class="reserved">return</span> output;
	}

behaviour.page.Page.<span class="reserved">prototype</span>.constructed = <span class="reserved">function</span>() {
	Log.warning(<span class="literal">"Non over-ridden call to Page.constucted()"</span>);
}

<span class="comment">/**
 * Bounces the user to a different page
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.boot = <span class="reserved">function</span>() {
	document.location = <span class="literal">"/"</span>;
}

<span class="comment">/**
 * Redraws the areas on the page in response to a resize or other stimulus
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.resizePanels = <span class="reserved">function</span>() {
	LayoutManager.resizePanels();
}

<span class="comment">/**
 * Default method, called when the url has no arguments after it
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.showLanding = <span class="reserved">function</span>() {
	
}

<span class="comment">/**
 * Should be overridden.
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.renderTreeList = <span class="reserved">function</span>() {
	
}

<span class="comment">/**
 * In order to avoid passing multiple copies of objects via AJAX, the list of objects is sent once and then all subsequent references to those objects are passed as 
 * arrays of numeric IDs refering to a field of the desired object (usually called "id").
 * 
 * This method calls behaviour.page.Page.processItem repeatedly to replace the numeric reference to the object with an actual "passed by reference" style reference.
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.processItems = <span class="reserved">function</span>(items, toReplace, replaceWith) {
	<span class="reserved">if</span>(items instanceof Array) {
		<span class="reserved">for</span>(var i = 0; i &lt; items.length; i++) {
			items[i] = <span class="reserved">this</span>.processItem(items[i], toReplace, replaceWith);
		}
	} <span class="reserved">else</span> {
		items = <span class="reserved">this</span>.processItem(items, toReplace, replaceWith);
	}
	
	<span class="reserved">return</span> items;
}

<span class="comment">/**
 * Links fields to objects in one parent element
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.processItem = <span class="reserved">function</span>(item, toReplace, replaceWith) {
	<span class="reserved">for</span>(var n = 0; n &lt; toReplace.length; n++) {
		<span class="reserved">if</span>(!(item[toReplace[n]] instanceof Array)) {
			item[toReplace[n]] = <span class="reserved">this</span>[replaceWith[n]].getElementWithKey(item[toReplace[n]]);
			continue;
		}
		
		<span class="reserved">for</span>(var k = 0; k &lt; item[toReplace[n]].length; k++) {
			var entity = <span class="reserved">this</span>[replaceWith[n]].getElementWithKey(item[toReplace[n]][k]);
		
			<span class="reserved">if</span>(entity) {
				item[toReplace[n]][k] = entity;
			}
		}
	}
	
	<span class="reserved">return</span> item;
}

<span class="comment">/**
 * Greys out the page and shows the passed element in the middle.  The passed element should
 * extend behaviour.gui.GUIWidget
 * 
 * <span class="attrib">@param</span>	{behaviour.gui.GUIWidget}	guiWidget
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.addModalLayer = <span class="reserved">function</span>(guiWidget) {
	try {
		<span class="reserved">if</span>(!<span class="reserved">this</span>.modalLayer) {
			<span class="reserved">this</span>.modalLayer = DOMUtil.createElement(<span class="literal">"div"</span>, {className: <span class="literal">"modalLayer"</span>, style: {display: <span class="literal">"none"</span>}});
			<span class="comment">//DOMUtil.addClass(this.modalLayer, "modalLayer");</span>
			<span class="comment">//this.modalLayer.style.display = "none";</span>
			
			document.body.appendChild(<span class="reserved">this</span>.modalLayer);
		}
		
		<span class="reserved">this</span>.modalLayerContents = guiWidget;
		<span class="reserved">this</span>.modalLayerContents.setStyle(<span class="literal">"display"</span>, <span class="literal">"none"</span>);
		<span class="reserved">this</span>.modalLayerContents.appendTo(document.body);
		
		Effect.Appear(<span class="reserved">this</span>.modalLayer, { duration: 0.25, to:0.8 });
		Effect.Appear(<span class="reserved">this</span>.modalLayerContents.getRootNode(), { duration: 0.25, to:1 });
	} catch(e) {
		Log.dumpObject(e);
	}
}

<span class="comment">/**
 * Fades out the layers added by com.proxim.page.Page.addModalLayer
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.clearModalLayer = <span class="reserved">function</span>() {
	<span class="reserved">if</span>(<span class="reserved">this</span>.modalLayer) {
		Effect.Fade(<span class="reserved">this</span>.modalLayer, { duration: 0.25 });
	}
	
	<span class="reserved">if</span>(<span class="reserved">this</span>.modalLayerContents) {
		Effect.Fade(<span class="reserved">this</span>.modalLayerContents.getRootNode(), { duration: 0.25 });
	}
	
	setTimeout(<span class="reserved">this</span>.removeModalLayer.bind(<span class="reserved">this</span>), 600);
}

<span class="comment">/**
 * Removes the layers added by com.proxim.page.Page.addModalLayer from the document tree
 */</span>
behaviour.page.Page.<span class="reserved">prototype</span>.removeModalLayer = <span class="reserved">function</span>() {
	Log.info(<span class="literal">"Removing modal layer"</span>);
	
	try {
		document.body.removeChild(<span class="reserved">this</span>.modalLayer);
		document.body.removeChild(<span class="reserved">this</span>.modalLayerContents.rootNode);
		
		<span class="reserved">this</span>.modalLayer = null;
		<span class="reserved">this</span>.modalLayerContents = null;
	} catch(e) {
		Log.warn(<span class="literal">"Exception thrown while removing modal layer - "</span> + e);
	}
}</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b></b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Tue Jul 17 12:45:55 2007</div>
</body>
</html>
